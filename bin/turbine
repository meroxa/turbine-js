#! /usr/bin/env node

require("dotenv").config();
const args = process.argv.slice(2);

const { run } = require("../lib/runner");
const { generate } = require("../lib/utils");

async function executeCommand() {
  let commandRun;
  if (args[0] === "test") {
    commandRun = await run("local", null, process.cwd());
  } else if (args[0] === "deploy") {
    commandRun = await run("production", "docker-local", args[1]);
  } else if (args[0] === "generate") {
    return generate(args[1], args[2]);
  } else {
    throw new Error("Invalid turbine command");
  }

  if (commandRun.err) {
    console.log(commandRun.val.unwrapMessage());
  }
}

executeCommand();
